# Daily Notes: 2026-02-16

**Pipeline PR #3** (10:30am PT)

## Progress

### Feature Branch
- Created: `feature/daily-2026-02-16-c`

### New Files Added
- `training/sft/train_waypoint_bc_with_metrics.py` - Waypoint BC trainer with integrated ADE/FDE evaluation metrics
- `training/sft/run_waypoint_bc_smoke.py` - Smoke tests

### Key Changes

1. **Evaluation-First Design** (per MEMORY.md architecture)
   - Added ADE (Average Displacement Error) and FDE (Final Displacement Error) metrics
   - Metrics computed every epoch during training (not just at the end)
   - Enables checkpoint selection based on quality metrics

2. **Residual Delta Learning Architecture**
   - `final_waypoints = sft_waypoints + delta_head(z)`
   - Keeps SFT backbone frozen, only trains small delta head
   - Model: `WaypointBCModel` with `DeltaHead` module

3. **Training Components**
   - `compute_ade()` / `compute_fde()` - Core metric functions
   - `compute_metrics()` - Batch-friendly metric aggregation
   - `DeltaHead` - Small neural network for residual adjustments
   - `WaypointBCModel` - Full model with frozen SFT + trainable delta
   - `train_waypoint_bc()` - Full training loop with integrated evaluation

### Smoke Test Results
```
ADE: 1.0000 | FDE: 2.0000
Trainable parameters: 66,696
Best FDE: 1.2622
```

## Next Steps
- Run full training on Waymo episode data
- Connect to CARLA ScenarioRunner evaluation
- Add checkpoint selection by best FDE
